(()=>{let r=0,n=null;function l(r=null){let l=[];if(r){let e=!1,a=!1;for(let t=0;t<r.items.length;t++)e|="text/plain"===r.items[t].type,a|="file"===r.items[t].kind;e&&l.push("text"),a&&l.push("file")}n&&l.push(n.getAttribute("flavor")),document.querySelectorAll("[droppable][flavor]").forEach(t=>{l.includes(t.getAttribute("flavor"))?t.classList.add("droppable"):t.classList.remove("droppable")}),document.querySelectorAll("[draggable][flavor]").forEach(t=>{n===t?t.classList.add("dragging"):t.classList.remove("dragging")})}On("dragstart","[draggable][flavor]",function(t){var e,a;r=0,n=this,l(),this!==t.target&&(e=this.getBoundingClientRect(),a=t.target.getBoundingClientRect(),t.dataTransfer.setDragImage(this,a.left-e.left+t.offsetX,a.top-e.top+t.offsetY))}),On("dragend","[draggable][flavor]",function(t){r=0,n=null,l()}),On("dragenter",document,function(t){r++||l(t.dataTransfer)}),On("dragover","[droppable][flavor]",function(e){var a=this.getAttribute("flavor");let r=n&&n.getAttribute("flavor")===a;for(let t=0;t<e.dataTransfer.items.length&&!r;t++)r|="text/plain"===e.dataTransfer.items[t].type&&"text"===a,r|="file"===e.dataTransfer.items[t].kind&&"file"===a;r&&e.preventDefault()}),On("dragleave",document,function(t){--r||l()}),On("drop","[droppable][flavor]",function(t){var e=this.getAttribute("flavor");let a=new Event("dropcomplete",{bubbles:!0});n?a.data=n:"file"===e&&t.dataTransfer.files.length?a.data=t.dataTransfer.files:"text"===e&&t.dataTransfer.getData("text/plain")&&(a.data=t.dataTransfer.getData("text/plain")),this.dispatchEvent(a),n=null,r=0,l(),t.preventDefault()})})();